<link rel="import" href="../../components/polymer/polymer.html">

<!-- build:remove -->
<link rel="import" href="../../components/iron-menu-behavior/iron-menu-behavior.html">
<script src="easeljs-0.8.1.min.js"></script>
<script src="easeljs-NEXT.combined.js"></script>
<script type="text/javascript" src="../../js/utils.js"></script>
<!-- /build -->

<dom-module id="ez-canvas">
    <template>

        <style>
            :host {
                display: block;

            }
            #myCanvas {
                width: 60vw;
            }


        </style>
        <canvas id="myCanvas" width="1500px" height="800px"></canvas>

    </template>

    <script>
        (function () {
            'use strict';

            Polymer({
                is: 'ez-canvas',

                attached: function() {
                    var canvas = this.$.myCanvas;
                    var field = measures();
                    var stage = new createjs.Stage(canvas);
                    var rect = new createjs.Shape();
                    var circle = new createjs.Shape();
                    circle.graphics.beginFill("#ff0000").drawCircle(100,100,10)

                    var rectangleGraphics = new createjs.Graphics()
                    rectangleGraphics.setStrokeStyle(2).beginFill('rgba(0,0,0,0.1)').beginStroke("rgba(0,0,0,0").mt(0, 0).lt(field.width, 0).lt(field.width, field.height).lt(0, field.height)
                    var rectangleShape = new createjs.Shape(rectangleGraphics)

                    var twoPointsLeft = new createjs.Graphics()
                    twoPointsLeft.setStrokeStyle(2).beginFill('rgba(0,0,0,0.1)').beginStroke("rgba(0,0,0,0)").mt(0, field.treyFromBorder).lt(field.treyLength, field.treyFromBorder).
                            arc(field.basketFromBorder, field.height / 2, field.treyRadius, Math.PI * 3 / 1.843, Math.PI / 2.688).
                            lt(0, field.height - field.treyFromBorder)
                    var twoPointsLeftShape = new createjs.Shape(twoPointsLeft);

                    var twoPointsRight = new createjs.Graphics()
                    twoPointsRight.setStrokeStyle(2).beginFill('rgba(0,0,0,0.1)').beginStroke("rgba(0,0,0,0)").mt(field.width - field.treyLength, field.treyFromBorder).lt(field.width, field.treyFromBorder).
                            lt(field.width, field.height - field.treyFromBorder).
                            arc(field.width - field.basketFromBorder, field.height / 2, field.treyRadius, Math.PI - Math.PI / 2.688, Math.PI - Math.PI * 3 / 1.843)
                    var twoPointsRightShape = new createjs.Shape(twoPointsRight);



                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").drawRect(0, 0, field.width, field.height);
                    // line
                    rect.graphics.setStrokeStyle(2).mt(field.width / 2, 0).lt(field.width / 2, field.height);
                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").arc(field.width / 2, field.height / 2, field.radius, 0, Math.PI * 2);
                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").
                            drawRect(0, field.height / 2 - (field.smallAreaHeight / 2), field.smallAreaWidth, field.smallAreaHeight);
                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").
                            drawRect(field.width - field.smallAreaWidth, field.height / 2 - (field.smallAreaHeight / 2), field.smallAreaWidth, field.smallAreaHeight);
                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").arc(field.smallAreaWidth, field.height / 2, field.radius, Math.PI * 3 / 2, Math.PI / 2);
                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").arc(field.width - field.smallAreaWidth, field.height / 2, field.radius, -Math.PI * 3 / 2, -Math.PI / 2);
                    // left side trey
                    rect.graphics.setStrokeStyle(2).mt(0, field.treyFromBorder).lt(field.treyLength, field.treyFromBorder);
                    rect.graphics.setStrokeStyle(2).mt(0, field.height - field.treyFromBorder).lt(field.treyLength, field.height - field.treyFromBorder);
                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").
                            arc(field.basketFromBorder, field.height / 2, field.treyRadius, Math.PI * 3 / 1.843, Math.PI / 2.688);

                    // right side trey
                    rect.graphics.setStrokeStyle(2).mt(field.width - field.treyLength, field.treyFromBorder).lt(field.width, field.treyFromBorder);
                    rect.graphics.setStrokeStyle(2).mt(field.width - field.treyLength, field.height - field.treyFromBorder).lt(field.width, field.height - field.treyFromBorder);
                    rect.graphics.setStrokeStyle(2).beginStroke("rgba(0,0,0,1)").
                            arc(field.width - field.basketFromBorder, field.height / 2, field.treyRadius, Math.PI - Math.PI / 2.688, Math.PI - Math.PI * 3 / 1.843);



                    stage.addChild(rectangleShape)
                    stage.addChild(twoPointsLeftShape)
                    stage.addChild(twoPointsRightShape)
                    stage.addChild(rect);
                    stage.update();

                    rectangleShape.on("click", function(e) {
                        console.log(e.stageX / field.width, e.stageY / field.height);
                        console.log("3 points")
                    });

                    twoPointsLeftShape.on("click", function(e) {
                        console.log(e.stageX / field.width, e.stageY / field.height);
                        console.log("2 points")
                    });
                    twoPointsRightShape.on("click", function(e) {
                        console.log(e.stageX / field.width, e.stageY / field.height);
                        console.log("2 points")
                    });
                }
            });
        })()

        function _getWidth() {
//            console.log(window.innerWidth)
          return window.innerWidth;

        }

        function _getHeight() {
            return window.innerHeight;
        }

        function measures() {
            var width = 1500;
            console.log(width)
            var ratio = width / 94;
            var field = {
                width: 94 * ratio,
                height: 50 * ratio,
                radius: 6 * ratio,
                smallAreaWidth: 19 * ratio,
                smallAreaHeight: 16 * ratio,
                treyFromBorder: 3 * ratio,
                treyLength: 14 * ratio,
                treyRadius: 23.9 * ratio,
                basketFromBorder: 4.6 * ratio,
            }
            return field;
        }
    </script>

</dom-module>